<!DOCTYPE html>
<html>

<head>
    <title>{{book.title}}</title>
    <link rel="stylesheet" href="stylesheets/style.css">
</head>
<nav>
    <ul>
		<li><a href="#/">Home</a></li>
        <li><a href="#/all_books.html">Books</a></li>
        <li><a href="#/all_patrons.html">Patrons</a></li>
        <li><a href="#/all_loans.html">Loans</a></li>
    </ul>
</nav>

<body>
    <h1>{{book.title}}</h1>
    <form>
        <p> <label for="title">Title</label><input id="title" type="text" value="{{book.title}}" ng-model="vm.book.title"></p>
        <p><label for="author">Author</label><input id="author" type="text" value="{{book.author}}" ng-model="vm.book.author"></p>
        <p><label for="genre">Genre</label><input id="genre" type="text" value="{{book.genre}}" ng-model="vm.book.genre"></p>
        <p><label for="first_published">First Published</label><input id="first_published" type="text" value="{{book.first_published}}" ng-model="vm.book.first_published"></p>
        <p><input type="submit" value="Update" ng-click="vm.putBookDetail()"></p>
    </form>
	<p ng-if="vm.success">Success</p>
	<p ng-if="vm.failure" ng-repeat="error in vm.errorMessages">{{error.message}}</p>
    <h2>Loan History</h2>
    <table>
        <thead>
            <tr>
                <th>Book</th>
                <th>Patron </th>
                <th>Loaned on</th>
                <th>Return by </th>
                <th>Returned on</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="loan in vm.book.loans">
                <td><a href="#/book_detail.html/{{loan.book_id}}">{{vm.book.title}}</a></td>
                <td><a href="#/patron_detail.html/{{loan.patron_id}}">{{loan.patron.first_name}} {{loan.patron.last_name}}</a></td>
                <td>{{loan.loaned_on}}</td>
                <td>{{loan.return_by}}</td>
                <td>{{loan.returned_on}}</td>
                <td><a ng-if="!loan.returned_on" href="#/return_book.html/{{loan.id}}" class="button">Return Book</a></td> 
            </tr>
        </tbody>
    </table>
</body>

</html>